import{j as e,b as Y,c as q,u as S}from"./vendor-CSTohHpX.js";import{r as h}from"./react-B9B04VyU.js";import{d as X,P as I,a as W,u as A,e as B,b as Q}from"./index-0HOOTYVG.js";import{N as L,F as V,L as F}from"./footer-CLqEREKu.js";import{B as b,L as l,T as f,I as u,i as J}from"./label-Dfj1YsHk.js";import{a as H}from"./openai-268ylVpD.js";var C="Progress",w=100,[Z,xe]=X(C),[ee,te]=Z(C),$=h.forwardRef((a,n)=>{const{__scopeProgress:x,value:d=null,max:o,getValueLabel:c=se,...p}=a;(o||o===0)&&!E(o)&&console.error(ae(`${o}`,"Progress"));const s=E(o)?o:w;d!==null&&!T(d,s)&&console.error(re(`${d}`,"Progress"));const m=T(d,s)?d:null,g=P(m)?c(m,s):void 0;return e.jsx(ee,{scope:x,value:m,max:s,children:e.jsx(I.div,{"aria-valuemax":s,"aria-valuemin":0,"aria-valuenow":P(m)?m:void 0,"aria-valuetext":g,role:"progressbar","data-state":R(m,s),"data-value":m??void 0,"data-max":s,...p,ref:n})})});$.displayName=C;var k="ProgressIndicator",G=h.forwardRef((a,n)=>{const{__scopeProgress:x,...d}=a,o=te(k,x);return e.jsx(I.div,{"data-state":R(o.value,o.max),"data-value":o.value??void 0,"data-max":o.max,...d,ref:n})});G.displayName=k;function se(a,n){return`${Math.round(a/n*100)}%`}function R(a,n){return a==null?"indeterminate":a===n?"complete":"loading"}function P(a){return typeof a=="number"}function E(a){return P(a)&&!isNaN(a)&&a>0}function T(a,n){return P(a)&&!isNaN(a)&&a<=n&&a>=0}function ae(a,n){return`Invalid prop \`max\` of value \`${a}\` supplied to \`${n}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${w}\`.`}function re(a,n){return`Invalid prop \`value\` of value \`${a}\` supplied to \`${n}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${w} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var K=$,ne=G;const z=h.forwardRef(({className:a,value:n,...x},d)=>e.jsx(K,{ref:d,className:W("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...x,children:e.jsx(ne,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));z.displayName=K.displayName;function ie({template:a,onComplete:n,onCancel:x}){const{toast:d}=A(),o=Y(),[c,p]=h.useState(1),[s,m]=h.useState({}),[g,y]=h.useState(!1),j=4,N=c/j*100,i=(t,U)=>{m(O=>({...O,[t]:U}))},r=q({mutationFn:async t=>await B("POST","/api/generate-document",t),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/generated-documents"]}),d({title:"Success",description:"Document generated successfully!"}),n()},onError:t=>{if(J(t)){d({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}d({title:"Error",description:"Failed to generate document. Please try again.",variant:"destructive"})}}),v=()=>{c<j&&p(t=>t+1)},D=()=>{c>1&&p(t=>t-1)},M=async()=>{y(!0);try{const t=await H(a.name,s);await r.mutateAsync({templateId:a.id,title:s.documentTitle||`${a.name} - ${new Date().toLocaleDateString()}`,formData:{...s,generatedContent:t}})}catch(t){console.error("Error generating document:",t),d({title:"Error",description:"Failed to generate document content. Please try again.",variant:"destructive"})}finally{y(!1)}},_=()=>{switch(c){case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Document Information"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Provide basic information about your document."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"documentTitle",children:"Document Title"}),e.jsx(u,{id:"documentTitle",placeholder:"Enter a title for your document",value:s.documentTitle||"",onChange:t=>i("documentTitle",t.target.value),"data-testid":"input-document-title"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"documentPurpose",children:"Purpose/Description"}),e.jsx(f,{id:"documentPurpose",placeholder:"Briefly describe the purpose of this document",value:s.documentPurpose||"",onChange:t=>i("documentPurpose",t.target.value),"data-testid":"textarea-document-purpose"})]})]})]});case 2:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Party Information"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Enter details about the parties involved in this document."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"First Party"}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"firstPartyName",children:"Full Name"}),e.jsx(u,{id:"firstPartyName",placeholder:"Enter full legal name",value:s.firstPartyName||"",onChange:t=>i("firstPartyName",t.target.value),"data-testid":"input-first-party-name"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"firstPartyAddress",children:"Address"}),e.jsx(f,{id:"firstPartyAddress",placeholder:"Enter complete address",value:s.firstPartyAddress||"",onChange:t=>i("firstPartyAddress",t.target.value),"data-testid":"textarea-first-party-address"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"firstPartyId",children:"ID/Passport Number"}),e.jsx(u,{id:"firstPartyId",placeholder:"Enter ID or passport number",value:s.firstPartyId||"",onChange:t=>i("firstPartyId",t.target.value),"data-testid":"input-first-party-id"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Second Party"}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"secondPartyName",children:"Full Name"}),e.jsx(u,{id:"secondPartyName",placeholder:"Enter full legal name",value:s.secondPartyName||"",onChange:t=>i("secondPartyName",t.target.value),"data-testid":"input-second-party-name"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"secondPartyAddress",children:"Address"}),e.jsx(f,{id:"secondPartyAddress",placeholder:"Enter complete address",value:s.secondPartyAddress||"",onChange:t=>i("secondPartyAddress",t.target.value),"data-testid":"textarea-second-party-address"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"secondPartyId",children:"ID/Passport Number"}),e.jsx(u,{id:"secondPartyId",placeholder:"Enter ID or passport number",value:s.secondPartyId||"",onChange:t=>i("secondPartyId",t.target.value),"data-testid":"input-second-party-id"})]})]})]})]});case 3:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Document Details"}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:["Provide specific details for your ",a.name.toLowerCase(),"."]})]}),e.jsxs("div",{className:"space-y-4",children:[a.category==="business"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"serviceDescription",children:"Service Description"}),e.jsx(f,{id:"serviceDescription",placeholder:"Describe the services to be provided",value:s.serviceDescription||"",onChange:t=>i("serviceDescription",t.target.value),"data-testid":"textarea-service-description"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"contractValue",children:"Contract Value (KES)"}),e.jsx(u,{id:"contractValue",type:"number",placeholder:"Enter amount in KES",value:s.contractValue||"",onChange:t=>i("contractValue",t.target.value),"data-testid":"input-contract-value"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"contractDuration",children:"Duration"}),e.jsx(u,{id:"contractDuration",placeholder:"e.g., 6 months, 1 year",value:s.contractDuration||"",onChange:t=>i("contractDuration",t.target.value),"data-testid":"input-contract-duration"})]})]})]}),a.category==="employment"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"jobTitle",children:"Job Title"}),e.jsx(u,{id:"jobTitle",placeholder:"Enter job title",value:s.jobTitle||"",onChange:t=>i("jobTitle",t.target.value),"data-testid":"input-job-title"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"salary",children:"Monthly Salary (KES)"}),e.jsx(u,{id:"salary",type:"number",placeholder:"Enter monthly salary",value:s.salary||"",onChange:t=>i("salary",t.target.value),"data-testid":"input-salary"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"startDate",children:"Start Date"}),e.jsx(u,{id:"startDate",type:"date",value:s.startDate||"",onChange:t=>i("startDate",t.target.value),"data-testid":"input-start-date"})]})]})]}),a.category==="property"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"propertyDescription",children:"Property Description"}),e.jsx(f,{id:"propertyDescription",placeholder:"Detailed description of the property",value:s.propertyDescription||"",onChange:t=>i("propertyDescription",t.target.value),"data-testid":"textarea-property-description"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"propertyValue",children:"Property Value (KES)"}),e.jsx(u,{id:"propertyValue",type:"number",placeholder:"Enter property value",value:s.propertyValue||"",onChange:t=>i("propertyValue",t.target.value),"data-testid":"input-property-value"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"titleDeedNumber",children:"Title Deed Number"}),e.jsx(u,{id:"titleDeedNumber",placeholder:"Enter title deed number",value:s.titleDeedNumber||"",onChange:t=>i("titleDeedNumber",t.target.value),"data-testid":"input-title-deed-number"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"additionalTerms",children:"Additional Terms & Conditions"}),e.jsx(f,{id:"additionalTerms",placeholder:"Any additional terms or special conditions",value:s.additionalTerms||"",onChange:t=>i("additionalTerms",t.target.value),"data-testid":"textarea-additional-terms"})]})]})]});case 4:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Review & Generate"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Review your information and generate the document."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"neu-card p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Document Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Title:"})," ",s.documentTitle||"Untitled"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Template:"})," ",a.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"First Party:"})," ",s.firstPartyName||"Not specified"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Second Party:"})," ",s.secondPartyName||"Not specified"]}),s.contractValue&&e.jsxs("div",{children:[e.jsx("strong",{children:"Value:"})," KES ",Number(s.contractValue).toLocaleString()]}),s.salary&&e.jsxs("div",{children:[e.jsx("strong",{children:"Salary:"})," KES ",Number(s.salary).toLocaleString()]}),s.propertyValue&&e.jsxs("div",{children:[e.jsx("strong",{children:"Property Value:"})," KES ",Number(s.propertyValue).toLocaleString()]})]})]}),e.jsxs("div",{className:"glass-panel p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fas fa-info-circle text-primary"}),e.jsx("h4",{className:"font-medium",children:"Document Generation"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your document will be generated using AI technology to ensure compliance with Kenyan law. The document will be available in both PDF and DOCX formats for download."})]})]})]});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx(L,{}),e.jsx("main",{className:"py-20 px-4 lg:px-8",children:e.jsxs("div",{className:"container mx-auto max-w-4xl",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:e.jsx("span",{className:"gradient-text",children:"Document Wizard"})}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:["Generate your ",a.name," using our step-by-step wizard"]}),e.jsxs("div",{className:"glass-panel p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Step ",c," of ",j]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[Math.round(N),"% Complete"]})]}),e.jsx(z,{value:N,className:"mb-4","data-testid":"wizard-progress"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[e.jsx("div",{className:c>=1?"text-primary":"text-muted-foreground",children:"Document Info"}),e.jsx("div",{className:c>=2?"text-primary":"text-muted-foreground",children:"Parties"}),e.jsx("div",{className:c>=3?"text-primary":"text-muted-foreground",children:"Details"}),e.jsx("div",{className:c>=4?"text-primary":"text-muted-foreground",children:"Review"})]})]})]}),e.jsx("div",{className:"neu-card p-8 mb-8",children:_()}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:c>1?e.jsxs(b,{variant:"outline",onClick:D,"data-testid":"button-previous",children:[e.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Previous"]}):e.jsx(b,{variant:"outline",onClick:x,"data-testid":"button-cancel",children:"Cancel"})}),e.jsx("div",{children:c<j?e.jsxs(b,{onClick:v,"data-testid":"button-next",children:["Next",e.jsx("i",{className:"fas fa-arrow-right ml-2"})]}):e.jsx(b,{onClick:M,disabled:g||r.isPending,className:"btn-accent","data-testid":"button-generate",children:g||r.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-magic mr-2"}),"Generate Document"]})})})]})]})}),e.jsx(V,{})]})}function he(){const{toast:a}=A(),{isAuthenticated:n,isLoading:x}=Q(),[d,o]=h.useState(""),[c,p]=h.useState(!1),[s,m]=h.useState(null);h.useEffect(()=>{if(!x&&!n){a({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{window.location.href="/api/login"},500);return}},[n,x,a]);const{data:g,isLoading:y}=S({queryKey:["/api/document-templates",d]}),{data:j,isLoading:N}=S({queryKey:["/api/generated-documents"],enabled:n}),i=r=>{m(r),p(!0)};return x?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"neu-card p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})}):c&&s?e.jsx(ie,{template:s,onComplete:()=>{p(!1),m(null)},onCancel:()=>{p(!1),m(null)}}):e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx(L,{}),e.jsx("main",{className:"py-20 px-4 lg:px-8",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("section",{className:"text-center mb-16",children:[e.jsxs("h1",{className:"text-4xl lg:text-6xl font-bold leading-tight mb-6",children:[e.jsx("span",{className:"gradient-text",children:"Document Assembly"}),e.jsx("br",{}),e.jsx("span",{className:"text-foreground",children:"Legal Document Generator"})]}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"Generate professional legal documents using our step-by-step wizard. Templates comply with Kenyan law and generate both PDF and DOCX formats."})]}),e.jsx("section",{className:"mb-12",children:e.jsxs("div",{className:"glass-panel p-6 max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Document Categories"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx("button",{onClick:()=>o(""),className:`p-3 rounded-lg transition-colors ${d===""?"bg-primary text-primary-foreground":"bg-secondary/50 hover:bg-secondary"}`,"data-testid":"category-all",children:"All Categories"}),F.map(r=>e.jsx("button",{onClick:()=>o(r.value),className:`p-3 rounded-lg transition-colors text-sm ${d===r.value?"bg-primary text-primary-foreground":"bg-secondary/50 hover:bg-secondary"}`,"data-testid":`category-${r.value}`,children:r.label},r.value))]})]})}),e.jsxs("section",{className:"mb-16",children:[e.jsx("h2",{className:"text-2xl font-bold mb-8 text-center",children:"Available Templates"}),y?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading templates..."})]}):g&&g.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(r=>{var v;return e.jsxs("div",{className:"neu-card p-6 interactive","data-testid":`template-${r.id}`,children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-accent/20 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"fas fa-file-alt text-accent text-xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:r.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:r.description}),e.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-1 rounded",children:(v=F.find(D=>D.value===r.category))==null?void 0:v.label})]})]}),e.jsxs("button",{onClick:()=>i(r),className:"w-full btn-accent","data-testid":`button-select-${r.id}`,children:[e.jsx("i",{className:"fas fa-magic mr-2"}),"Start Document"]})]},r.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"fas fa-file-alt text-muted-foreground text-4xl mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No templates available for this category."})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-8 text-center",children:"Your Documents"}),N?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading your documents..."})]}):j&&j.length>0?e.jsx("div",{className:"space-y-4",children:j.map(r=>{var v;return e.jsx("div",{className:"neu-card p-6","data-testid":`document-${r.id}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/20 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"fas fa-file text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:r.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Template: ",(v=r.template)==null?void 0:v.name," • Created: ",new Date(r.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.pdfUrl&&e.jsxs("a",{href:r.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-primary text-sm","data-testid":`download-pdf-${r.id}`,children:[e.jsx("i",{className:"fas fa-file-pdf mr-1"}),"PDF"]}),r.docxUrl&&e.jsxs("a",{href:r.docxUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-secondary text-sm","data-testid":`download-docx-${r.id}`,children:[e.jsx("i",{className:"fas fa-file-word mr-1"}),"DOCX"]})]})]})},r.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"fas fa-folder-open text-muted-foreground text-4xl mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"You haven't generated any documents yet."}),e.jsx("button",{onClick:()=>o(""),className:"btn-primary","data-testid":"button-start-first-document",children:"Create Your First Document"})]})]})]})}),e.jsx(V,{})]})}export{he as default};
